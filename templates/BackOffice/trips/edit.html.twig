{% extends 'BackOffice/base.html.twig' %}

{% block title %}Ajouter un trajet{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .form-error {
            color: #ff3e1d;
            font-size: 0.875em;
            margin-top: 0.25rem;
            font-weight: 500;
        }
        .is-invalid {
            border-color: #ff3e1d !important;
        }
        .form-control.is-invalid:focus {
            box-shadow: 0 0 0 0.25rem rgba(255, 62, 29, 0.25);
        }
        .error-icon {
            color: #ff3e1d;
            margin-right: 5px;
        }
    </style>
{% endblock %}

{% block body %}
<div class="container-xxl flex-grow-1 container-p-y">
    <h4 class="fw-bold py-3 mb-4">
        <span class="text-muted fw-light">Admin / Trajets /</span> modification du trajet
    </h4>

    <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="mb-0">Modifier le trajet</h5>
            <a href="{{ path('app_admin_trips_index') }}" class="btn btn-secondary">
                <i class="bx bx-arrow-back me-1"></i> Retour
            </a>
        </div>
        <div class="card-body">
            {{ form_start(form) }}
                <div class="row mb-3">
                    <div class="col-md-6">
                        {{ form_label(form.departure, 'Lieu de départ', {'label_attr': {'class': 'form-label'}}) }}
                        {{ form_widget(form.departure, {
                            'attr': {
                                'class': 'form-control' ~ (form.departure.vars.errors|length ? ' is-invalid' : ''),
                                'placeholder': 'Ex: Tunis'
                            }
                        }) }}
                        <div class="form-error">
                            {% for error in form.departure.vars.errors %}
                                <div><i class="bx bx-error-circle error-icon"></i>{{ error.message }}</div>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="col-md-6">
                        {{ form_label(form.destination, 'Destination', {'label_attr': {'class': 'form-label'}}) }}
                        {{ form_widget(form.destination, {
                            'attr': {
                                'class': 'form-control' ~ (form.destination.vars.errors|length ? ' is-invalid' : ''),
                                'placeholder': 'Ex: Ariana'
                            }
                        }) }}
                        <div class="form-error">
                            {% for error in form.destination.vars.errors %}
                                <div><i class="bx bx-error-circle error-icon"></i>{{ error.message }}</div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-md-6">
                        {{ form_label(form.departureTime, 'Heure de départ', {'label_attr': {'class': 'form-label'}}) }}
                        {{ form_widget(form.departureTime, {
                            'attr': {
                                'class': 'form-control datetimepicker' ~ (form.departureTime.vars.errors|length ? ' is-invalid' : '')
                            }
                        }) }}
                        <div class="form-error">
                            {% for error in form.departureTime.vars.errors %}
                                <div><i class="bx bx-error-circle error-icon"></i>{{ error.message }}</div>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="col-md-6">
                        {{ form_label(form.arrivalTime, 'Heure d\'arrivée', {'label_attr': {'class': 'form-label'}}) }}
                        {{ form_widget(form.arrivalTime, {
                            'attr': {
                                'class': 'form-control datetimepicker' ~ (form.arrivalTime.vars.errors|length ? ' is-invalid' : '')
                            }
                        }) }}
                        <div class="form-error">
                            {% for error in form.arrivalTime.vars.errors %}
                                <div><i class="bx bx-error-circle error-icon"></i>{{ error.message }}</div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-md-6">
                        {{ form_label(form.capacity, 'Nombre de places', {'label_attr': {'class': 'form-label'}}) }}
                        {{ form_widget(form.capacity, {
                            'attr': {
                                'class': 'form-control' ~ (form.capacity.vars.errors|length ? ' is-invalid' : ''),
                                'placeholder': 'Ex: 50'
                            }
                        }) }}
                        <div class="form-error">
                            {% for error in form.capacity.vars.errors %}
                                <div><i class="bx bx-error-circle error-icon"></i>{{ error.message }}</div>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="col-md-6">
                        {{ form_label(form.price, 'Prix (DT)', {'label_attr': {'class': 'form-label'}}) }}
                        {{ form_widget(form.price, {
                            'attr': {
                                'class': 'form-control' ~ (form.price.vars.errors|length ? ' is-invalid' : ''),
                                'placeholder': 'Ex: 29.99'
                            }
                        }) }}
                        <div class="form-error">
                            {% for error in form.price.vars.errors %}
                                <div><i class="bx bx-error-circle error-icon"></i>{{ error.message }}</div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                
                <div class="mt-4">
                    <button type="submit" class="btn btn-primary">
                        <i class="bx bx-save me-1"></i>Mettre à jour le trajet
                    </button>
                </div>
            {{ form_end(form) }}
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            $('.datetimepicker').datetimepicker({
                format: 'YYYY-MM-DD HH:mm',
                sideBySide: true
            });
        });
    </script>
{% endblock %}