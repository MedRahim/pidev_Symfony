<!doctype html>
<html class="no-js" lang="zxx">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Directory HTML-5 Template </title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="manifest" href="site.webmanifest">
		<link rel="shortcut icon" type="image/x-icon" href="{{ asset('FrontOffice/assets/img/favicon.ico') }}">

		<!-- CSS here -->
            <link rel="stylesheet" href="{{ asset('FrontOffice/assets/css/bootstrap.min.css') }}">
            <link rel="stylesheet" href="{{ asset('FrontOffice/assets/css/owl.carousel.min.css') }}">
            <link rel="stylesheet" href="{{ asset('FrontOffice/assets/css/slicknav.css') }}">
            <link rel="stylesheet" href="{{ asset('FrontOffice/assets/css/flaticon.css') }}">
            <link rel="stylesheet" href="{{ asset('FrontOffice/assets/css/price_rangs.css') }}">
            <link rel="stylesheet" href="{{ asset('FrontOffice/assets/css/animate.min.css') }}">
            <link rel="stylesheet" href="{{ asset('FrontOffice/assets/css/magnific-popup.css') }}">
            <link rel="stylesheet" href="{{ asset('FrontOffice/assets/css/fontawesome-all.min.css') }}">
            <link rel="stylesheet" href="{{ asset('FrontOffice/assets/css/themify-icons.css') }}">
            <link rel="stylesheet" href="{{ asset('FrontOffice/assets/css/slick.css') }}">
            <link rel="stylesheet" href="{{ asset('FrontOffice/assets/css/nice-select.css') }}">
            <link rel="stylesheet" href="{{ asset('FrontOffice/assets/css/style.css') }}">
   </head>

   <body>
    <!-- Preloader Start -->
    <div id="preloader-active">
        <div class="preloader d-flex align-items-center justify-content-center">
            <div class="preloader-inner position-relative">
                <div class="preloader-circle"></div>
                <div class="preloader-img pere-text">
                    <img src="{{ asset('FrontOffice/assets/img/logo/loder.jpg') }}" alt="">
                </div>
            </div>
        </div>
    </div>
    <!-- Preloader Start -->
    <header>
        <!-- Header Start -->
       <div class="header-area header-transparent">
            <div class="main-header">
               <div class="header-bottom  header-sticky">
                    <div class="container-fluid">
                        <div class="row align-items-center">
                            <!-- Logo -->
                            <div class="col-xl-2 col-lg-2 col-md-1">
                                <div class="logo">
                                  <a href="index.html"><img src="{{ asset('FrontOffice/assets/img/logo/logo.png') }}" alt=""></a>
                                </div>
                            </div>
                            <div class="col-xl-10 col-lg-10 col-md-8">
                                <!-- Main-menu -->
                                <div class="main-menu f-right d-none d-lg-block">
                                    <nav>
                                        <ul id="navigation">                                                                                                                                     
                                            <li><a href="{{ asset('FrontOffice/index.html.twig') }}">Home</a></li>
                                            <li><a href="{{ asset('FrontOffice/about.html.twig') }}">About</a></li>
                                            <li><a href="{{ asset('FrontOffice/categori.html.twig') }}">Categories</a></li>
                                            <li><a href="{{ asset('FrontOffice/listing.html.twig') }}">Listing</a></li>
                                            <li><a href="#">Page</a>
                                                <ul class="submenu">
                                                    <li><a href="{{ asset('FrontOffice/blog.html.twig') }}">Blog</a></li>
                                                    <li><a href="{{ asset('FrontOffice/blog-details.html.twig') }}">Blog Details</a></li>
                                                    <li><a href="{{ asset('FrontOffice/elements.html.twig') }}">Element</a></li>
                                                    <li><a href="{{ asset('FrontOffice/listing-details.html.twig') }}">Listing Details</a></li>
                                                </ul>
                                            </li>
                                            <li><a href="{{ asset('FrontOffice/contact.html.twig') }}">Contact</a></li>
                                            <li class="add-list"><a href="listing_details.html"><i class="ti-plus"></i> add Listing</a></li>
                                            <li class="login"><a href="#">
                                                <i class="ti-user"></i> Sign in or Register</a>
                                            </li>
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                            <!-- Mobile Menu -->
                            <div class="col-12">
                                <div class="mobile_menu d-block d-lg-none"></div>
                            </div>
                        </div>
                    </div>
               </div>
            </div>
       </div>
        <!-- Header End -->
    </header>
    <main>

        <!-- Hero Start-->
        <div class="hero-area3 hero-overly2 d-flex align-items-center ">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-xl-8 col-lg-9">
                        <div class="hero-cap text-center pt-50 pb-20">
                            <h2>Our Listing</h2>
                        </div>
                        <!--Hero form -->
                        <form action="#" class="search-box search-box2">
                            <div class="input-form">
                                <input type="text" placeholder="What are you looking for?">
                            </div>
                            <div class="select-form">
                                <div class="select-itms">
                                    <select name="select" id="select1">
                                        <option value="">All Catagories</option>
                                        <option value="">Catagories One</option>
                                        <option value="">Catagories Two</option>
                                        <option value="">Catagories Three</option>
                                        <option value="">Catagories Four</option>
                                    </select>
                                </div>
                            </div>
                            <!-- Search box -->
                            <div class="search-form">
                                <a href="#">Search</a>
                            </div>	
                        </form>	
                    </div>
                </div>
            </div>
        </div>
        <!--Hero End -->
        <!-- listing Area Start -->
        <div class="listing-area pt-120 pb-120">
            <div class="container">
                <div class="row">
                    <!-- Left content -->
                    <div class="col-xl-4 col-lg-4 col-md-6">
                        <div class="row">
                            <div class="col-12">
                                    <div class="small-section-tittle2 mb-45">
                                    <h4>Advanced Filter</h4>
                                </div>
                            </div>
                        </div>
                        <!-- Job Category Listing start -->
                        <div class="category-listing mb-50">
                            <!-- single one -->
                            <div class="single-listing">
                                <!-- input -->
                                <form method="get" action="{{ path('app_product_listing') }}" id="product-filter-form">
                                    <div class="input-form">
                                        <input type="text" name="name" placeholder="What are you finding?" value="{{ searchName|default('') }}">
                                    </div>
                                    <!-- Price Range Slider Start -->
                                    <aside class="left_widgets p_filter_widgets price_rangs_aside sidebar_box_shadow" style="margin-top: 20px;">
                                        <div class="small-section-tittle2">
                                            <h4>Price range</h4>
                                        </div>
                                        <div class="widgets_inner">
                                            <div class="range_item">
                                                <input type="text" class="js-range-slider" value="" />
                                                <div class="d-flex align-items-center">
                                                    <div class="price_text">
                                                        <p>Price :</p>
                                                    </div>
                                                    <div class="price_value d-flex justify-content-center">
                                                        <input type="text" class="js-input-from" id="amount-from" readonly style="width:60px;" />
                                                        <span>to</span>
                                                        <input type="text" class="js-input-to" id="amount-to" readonly style="width:60px;" />
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Hidden fields for min/max price -->
                                            <input type="hidden" name="min_price" id="min_price" value="{{ minPrice is defined and minPrice is not null ? minPrice : 0 }}">
                                            <input type="hidden" name="max_price" id="max_price" value="{{ maxPrice is defined and maxPrice is not null ? maxPrice : 1000 }}">
                                        </div>
                                    </aside>
                                    <!-- Price Range Slider End -->
                                    <button type="submit" class="btn list-btn mt-20">Search</button>
                                </form>
                                <!-- Select job items start -->
                                <!--  Select job items End-->
                                <!-- select-Categories start -->
                                <!-- select-Categories End -->
                                <!-- Select job items start -->
                                <!--  Select job items End-->
                            </div>
                        </div>
                        <!-- Job Category Listing End -->
                    </div>
                    <!-- Right content -->
                    <div class="col-xl-8 col-lg-8 col-md-6">
                        <div class="row">
                            <div class="col-lg-12 d-flex justify-content-between align-items-center mb-3">
                                <div class="count mb-0">
                                    <span>5432 Listings are available</span>
                                </div>
                                <!-- Pannier Button -->
                                <a href="{{ path('app_order_pannier') }}" class="btn btn-warning btn-lg" style="display: flex; align-items: center; gap: 8px;">
                                    <i class="fa fa-shopping-cart"></i> Pannier
                                </a>
                            </div>
                        </div>
                        <!-- listing Details Stat-->
                        <div class="listing-details-area">
                            <div class="container">
                                <div class="row">
                                    {% if products is defined and products is not empty %}
                                        {% for product in products %}
                                            <div class="col-lg-6">
                                                <div class="single-listing mb-30">
                                                    <div class="list-img">
                                                        <img src="{{ product.imagePath ? asset(product.imagePath) : asset('FrontOffice/assets/img/default-product.jpg') }}" alt="{{ product.name }}">
                                                    </div>
                                                    <div class="list-caption">
                                                        <h3>{{ product.name }}</h3>
                                                        <p>{{ product.description }}</p>
                                                        <p><strong>Price:</strong> {{ product.price }} USD</p>
                                                        <p><strong>Stock:</strong> {{ product.stock }}</p>
                                                        <div class="d-flex align-items-center">
                                                            <input
                                                                type="number"
                                                                class="form-control me-2"
                                                                style="width: 80px;"
                                                                min="1"
                                                                max="{{ product.stock }}"
                                                                value="1"
                                                                id="quantity-{{ product.id }}"
                                                            />
                                                            <button
                                                                class="btn btn-primary buy-btn"
                                                                data-product-id="{{ product.id }}"
                                                                data-toggle="modal"
                                                                data-target="#orderModal"
                                                            >
                                                                Buy
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        {% endfor %}
                                    {% else %}
                                        <p>No products available.</p>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <!-- listing Details End -->
                        <!--Pagination Start  -->
                        <div class="pagination-area pt-70 text-center">
                            <div class="container">
                                <div class="row">
                                    <div class="col-xl-12">
                                        <div class="single-wrap d-flex justify-content-center">
                                            <nav aria-label="Page navigation example">
                                                <ul class="pagination justify-content-start">
                                                    <li class="page-item active"><a class="page-link" href="#">01</a></li>
                                                    <li class="page-item"><a class="page-link" href="#">02</a></li>
                                                    <li class="page-item"><a class="page-link" href="#">03</a></li>
                                                <li class="page-item"><a class="page-link" href="#"><span class="ti-angle-right"></span></a></li>
                                                </ul>
                                            </nav>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--Pagination End  -->
                    </div>
                </div>
            </div>
        </div>
        <!-- listing-area Area End -->

    </main>
    <footer>
        <!-- Footer Start-->
        <div class="footer-area">
            <div class="container">
               <div class="footer-top footer-padding">
                    <div class="row justify-content-between">
                        <div class="col-xl-3 col-lg-4 col-md-4 col-sm-6">
                            <div class="single-footer-caption mb-50">
                                <div class="single-footer-caption mb-30">
                                    <!-- logo -->
                                    <div class="footer-logo">
                                        <a href="index.html"><img src="{{ asset('FrontOffice/assets/img/logo/logo2_footer.png') }}" alt=""></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xl-2 col-lg-2 col-md-4 col-sm-6">
                            <div class="single-footer-caption mb-50">
                                <div class="footer-tittle">
                                    <h4>Quick Link</h4>
                                    <ul>
                                        <li><a href="#">Home</a></li>
                                        <li><a href="#">Listing</a></li>
                                        <li><a href="#">About</a></li>
                                        <li><a href="#">Contact</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6">
                            <div class="single-footer-caption mb-50">
                                <div class="footer-tittle">
                                    <h4>Categories</h4>
                                    <ul>
                                        <li><a href="#">Reasonable Hotel</a></li>
                                        <li><a href="#">Popular Restaurant</a></li>
                                        <li><a href="#">Easy Shopping</a></li>
                                        <li><a href="#">Night Life</a></li>     
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-xl-3 col-lg-3 col-md-4 col-sm-6">
                            <div class="single-footer-caption mb-50">
                                <div class="footer-tittle">
                                    <h4>Download App</h4>
                                    <ul>
                                        <li class="app-log"><a href="#"><img src="{{ asset('FrontOffice/assets/img/gallery/app-logo.png') }}" alt=""></a></li>
                                        <li><a href="#"><img src="{{ asset('FrontOffice/assets/img/gallery/app-logo2.png') }}" alt=""></a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
               </div>
                <div class="footer-bottom">
                    <div class="row d-flex justify-content-between align-items-center">
                        <div class="col-xl-9 col-lg-8">
                            <div class="footer-copy-right">
                                <p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
  Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="fa fa-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
  <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
                            </div>
                        </div>
                        <div class="col-xl-3 col-lg-4">
                            <!-- Footer Social -->
                            <div class="footer-social f-right">
                                <a href="#"><i class="fab fa-facebook-f"></i></a>
                                <a href="#"><i class="fab fa-twitter"></i></a>
                                <a href="#"><i class="fas fa-globe"></i></a>
                                <a href="#"><i class="fab fa-instagram"></i></a>
                            </div>
                        </div>
                    </div>
               </div>
            </div>
        </div>
        <!-- Footer End-->
    </footer>
    <!-- Scroll Up -->
    <div id="back-top" >
        <a title="Go to Top" href="#"> <i class="fas fa-level-up-alt"></i></a>
    </div>


    <!-- JS here -->
		<!-- All JS Custom Plugins Link Here here -->
        <script src="{{ asset('FrontOffice/assets/js/vendor/modernizr-3.5.0.min.js') }}"></script>
		<!-- Jquery, Popper, Bootstrap -->
		<script src="{{ asset('FrontOffice/assets/js/vendor/jquery-1.12.4.min.js') }}"></script>
        <script src="{{ asset('FrontOffice/assets/js/popper.min.js') }}"></script>
        <script src="{{ asset('FrontOffice/assets/js/bootstrap.min.js') }}"></script>
	    <!-- Jquery Mobile Menu -->
        <script src="{{ asset('FrontOffice/assets/js/jquery.slicknav.min.js') }}"></script>

		<!-- Jquery Slick , Owl-Carousel Plugins -->
        <script src="{{ asset('FrontOffice/assets/js/owl.carousel.min.js') }}"></script>
        <script src="{{ asset('FrontOffice/assets/js/slick.min.js') }}"></script>
		<!-- One Page, Animated-HeadLin -->
        <script src="{{ asset('FrontOffice/assets/js/wow.min.js') }}"></script>
        <script src="{{ asset('FrontOffice/assets/js/price-range.js') }}"></script>
		<script src="{{ asset('FrontOffice/assets/js/animated.headline.js') }}"></script>
        <script src="{{ asset('FrontOffice/assets/js/jquery.magnific-popup.js') }}"></script>

		<!-- Nice-select, sticky -->
        <script src="{{ asset('FrontOffice/assets/js/jquery.nice-select.min.js') }}"></script>
		<script src="{{ asset('FrontOffice/assets/js/jquery.sticky.js') }}"></script>
        
        <!-- contact js -->
        <script src="{{ asset('FrontOffice/assets/js/contact.js') }}"></script>
        <script src="{{ asset('FrontOffice/assets/js/jquery.form.js') }}"></script>
        <script src="{{ asset('FrontOffice/assets/js/jquery.validate.min.js') }}"></script>
        <script src="{{ asset('FrontOffice/assets/js/mail-script.js') }}"></script>
        <script src="{{ asset('FrontOffice/assets/js/jquery.ajaxchimp.min.js') }}"></script>
        
		<!-- Jquery Plugins, main Jquery -->	
        <script src="{{ asset('FrontOffice/assets/js/plugins.js') }}"></script>
        <script src="{{ asset('FrontOffice/assets/js/main.js') }}"></script>
        
    <!-- Order Confirmation Modal -->
    <div class="modal fade" id="orderModal" tabindex="-1" role="dialog" aria-labelledby="orderModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="orderModalLabel">Order Received</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            Your order has been placed! Please await confirmation.
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    {% set sliderMin = 0 %}
    {% set sliderMax = 1000 %}
    {% set sliderFrom = minPrice is defined and minPrice is not null ? minPrice : sliderMin %}
    {% set sliderTo = maxPrice is defined and maxPrice is not null ? maxPrice : sliderMax %}

    <script>
      $(function(){
        var $slider = $('.js-range-slider');
        if ($slider.length && typeof $.fn.ionRangeSlider === 'function') {
          var sliderInstance = $slider.ionRangeSlider({
            type: 'double',
            min: {{ sliderMin }},
            max: {{ sliderMax }},
            from: {{ sliderFrom }},
            to: {{ sliderTo }},
            prefix: "$",
            onStart: updateInputs,
            onChange: updateInputs,
            onFinish: updateInputs
          }).data("ionRangeSlider");

          // Ensure hidden fields are updated on page load
          $('#amount-from').val({{ sliderFrom }});
          $('#amount-to').val({{ sliderTo }});
          $('#min_price').val({{ sliderFrom }});
          $('#max_price').val({{ sliderTo }});
        }

        function updateInputs(data) {
          $('#amount-from').val(data.from);
          $('#amount-to').val(data.to);
          $('#min_price').val(data.from);
          $('#max_price').val(data.to);
        }

        $('.buy-btn').on('click', function(e){
          e.preventDefault();

          const productId = $(this).data('product-id');
          const quantity = $('#quantity-' + productId).val(); // Get quantity value
          const csrfToken = '{{ csrf_token("order") }}'; // Fetch CSRF token

          const url = '{{ path("order_create") }}';

          $.ajax({
            url: url,
            method: 'POST',
            data: JSON.stringify({ productId: productId, quantity: quantity, _csrf_token: csrfToken }),
            contentType: 'application/json',
            success: function(response) {
              if (response.success) {
                alert('Order created successfully. Awaiting admin approval.');
              } else {
                alert('Error placing order: ' + response.error);
              }
            },
            error: function(xhr) {
              alert('Request failed: ' + xhr.statusText);
            }
          });
        });
      });
    </script>

    <style>
    /* Add custom style for the Pannier button */
    .btn.btn-warning.btn-lg {
        font-size: 1.1rem;
        font-weight: 600;
        border-radius: 30px;
        padding: 10px 28px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        transition: background 0.2s;
    }
    .btn.btn-warning.btn-lg:hover {
        background: #ffae00;
        color: #fff;
    }
    </style>
</body>
</html>